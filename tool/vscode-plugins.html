<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VSCode插件开发笔记 | 一葦</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/icons/favicon.ico">
    <link rel="manifest" href="/js/mainfest.json">
    <link rel="stylesheet" href="/styles/css/style.css">
    <script type="utf-8" src="/js/disable-user-zoom.js"></script>
    <meta name="description" content="这是一苇的前端技术博客哦~">
    <meta name="Author" content="一苇">
    <meta rel="keywords" content="verneyzhou,阿沐,一苇,前端,docs.verneyzhou-code.cn,博客,fe,IT,技术">
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <meta name="viewport" content="width=device-width,width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.3c92d36b.css" as="style"><link rel="preload" href="/assets/js/app.2e7fb202.js" as="script"><link rel="preload" href="/assets/js/3.7ffbe2ab.js" as="script"><link rel="preload" href="/assets/js/197.06887a14.js" as="script"><link rel="preload" href="/assets/js/4.245b4373.js" as="script"><link rel="prefetch" href="/assets/js/10.4d0c49b9.js"><link rel="prefetch" href="/assets/js/100.0d78136f.js"><link rel="prefetch" href="/assets/js/101.1b5029b7.js"><link rel="prefetch" href="/assets/js/102.2acf0798.js"><link rel="prefetch" href="/assets/js/103.c632265b.js"><link rel="prefetch" href="/assets/js/104.37e76a05.js"><link rel="prefetch" href="/assets/js/105.eea9ab57.js"><link rel="prefetch" href="/assets/js/106.94b0173f.js"><link rel="prefetch" href="/assets/js/107.bb9864ef.js"><link rel="prefetch" href="/assets/js/108.47949515.js"><link rel="prefetch" href="/assets/js/109.b7a80d3b.js"><link rel="prefetch" href="/assets/js/11.c766cbe6.js"><link rel="prefetch" href="/assets/js/110.65eef9d4.js"><link rel="prefetch" href="/assets/js/111.5d7f05a0.js"><link rel="prefetch" href="/assets/js/112.79f7a23f.js"><link rel="prefetch" href="/assets/js/113.d2a488d0.js"><link rel="prefetch" href="/assets/js/114.6e8e24ea.js"><link rel="prefetch" href="/assets/js/115.f13f5e93.js"><link rel="prefetch" href="/assets/js/116.c48f3f00.js"><link rel="prefetch" href="/assets/js/117.9e71874c.js"><link rel="prefetch" href="/assets/js/118.0365691c.js"><link rel="prefetch" href="/assets/js/119.ddf35541.js"><link rel="prefetch" href="/assets/js/12.530223f1.js"><link rel="prefetch" href="/assets/js/120.d6a23d9e.js"><link rel="prefetch" href="/assets/js/121.a481fcc4.js"><link rel="prefetch" href="/assets/js/122.fa395dd6.js"><link rel="prefetch" href="/assets/js/123.8dee52e0.js"><link rel="prefetch" href="/assets/js/124.43a76748.js"><link rel="prefetch" href="/assets/js/125.2b5713d4.js"><link rel="prefetch" href="/assets/js/126.e571be5d.js"><link rel="prefetch" href="/assets/js/127.87d15002.js"><link rel="prefetch" href="/assets/js/128.024359e4.js"><link rel="prefetch" href="/assets/js/129.9884b4bb.js"><link rel="prefetch" href="/assets/js/13.299e9c3c.js"><link rel="prefetch" href="/assets/js/130.8e8ec392.js"><link rel="prefetch" href="/assets/js/131.a56bbf5a.js"><link rel="prefetch" href="/assets/js/132.e369e8a1.js"><link rel="prefetch" href="/assets/js/133.dd8d6f15.js"><link rel="prefetch" href="/assets/js/134.587a8860.js"><link rel="prefetch" href="/assets/js/135.1301161b.js"><link rel="prefetch" href="/assets/js/136.71e96e71.js"><link rel="prefetch" href="/assets/js/137.1a8b5705.js"><link rel="prefetch" href="/assets/js/138.13573423.js"><link rel="prefetch" href="/assets/js/139.2ed5be55.js"><link rel="prefetch" href="/assets/js/14.27619466.js"><link rel="prefetch" href="/assets/js/140.49f93f23.js"><link rel="prefetch" href="/assets/js/141.db65eedf.js"><link rel="prefetch" href="/assets/js/142.35c03ef7.js"><link rel="prefetch" href="/assets/js/143.d9a753d2.js"><link rel="prefetch" href="/assets/js/144.8d179568.js"><link rel="prefetch" href="/assets/js/145.0fd8eda5.js"><link rel="prefetch" href="/assets/js/146.1614cd31.js"><link rel="prefetch" href="/assets/js/147.1f8c8945.js"><link rel="prefetch" href="/assets/js/148.377a6f55.js"><link rel="prefetch" href="/assets/js/149.3cce8fa6.js"><link rel="prefetch" href="/assets/js/15.5e163b6d.js"><link rel="prefetch" href="/assets/js/150.197796dc.js"><link rel="prefetch" href="/assets/js/151.8be597a5.js"><link rel="prefetch" href="/assets/js/152.65a308c5.js"><link rel="prefetch" href="/assets/js/153.f1a4e460.js"><link rel="prefetch" href="/assets/js/154.9e3c6051.js"><link rel="prefetch" href="/assets/js/155.32737f02.js"><link rel="prefetch" href="/assets/js/156.7f7b8a0d.js"><link rel="prefetch" href="/assets/js/157.1d4c8316.js"><link rel="prefetch" href="/assets/js/158.a11096ba.js"><link rel="prefetch" href="/assets/js/159.f9f6c076.js"><link rel="prefetch" href="/assets/js/16.6377681b.js"><link rel="prefetch" href="/assets/js/160.1a984fc3.js"><link rel="prefetch" href="/assets/js/161.c0bdace0.js"><link rel="prefetch" href="/assets/js/162.45223b4c.js"><link rel="prefetch" href="/assets/js/163.dca039a1.js"><link rel="prefetch" href="/assets/js/164.7607d0bf.js"><link rel="prefetch" href="/assets/js/165.c5621110.js"><link rel="prefetch" href="/assets/js/166.0bb7199e.js"><link rel="prefetch" href="/assets/js/167.9a9fbb7d.js"><link rel="prefetch" href="/assets/js/168.e1acfe91.js"><link rel="prefetch" href="/assets/js/169.1fdc14d0.js"><link rel="prefetch" href="/assets/js/17.1c1908ab.js"><link rel="prefetch" href="/assets/js/170.b70b623c.js"><link rel="prefetch" href="/assets/js/171.9815d143.js"><link rel="prefetch" href="/assets/js/172.fff650d5.js"><link rel="prefetch" href="/assets/js/173.9c7cc3bb.js"><link rel="prefetch" href="/assets/js/174.52d7ea40.js"><link rel="prefetch" href="/assets/js/175.beb33995.js"><link rel="prefetch" href="/assets/js/176.f894af4b.js"><link rel="prefetch" href="/assets/js/177.d8a9b44f.js"><link rel="prefetch" href="/assets/js/178.71c66889.js"><link rel="prefetch" href="/assets/js/179.d413059e.js"><link rel="prefetch" href="/assets/js/18.77f3e444.js"><link rel="prefetch" href="/assets/js/180.b50d733c.js"><link rel="prefetch" href="/assets/js/181.335287be.js"><link rel="prefetch" href="/assets/js/182.5b4e8b26.js"><link rel="prefetch" href="/assets/js/183.9c839eb7.js"><link rel="prefetch" href="/assets/js/184.e2d2291e.js"><link rel="prefetch" href="/assets/js/185.6468084e.js"><link rel="prefetch" href="/assets/js/186.318b0476.js"><link rel="prefetch" href="/assets/js/187.a5f81ff0.js"><link rel="prefetch" href="/assets/js/188.d0a32c4f.js"><link rel="prefetch" href="/assets/js/189.c0316fa5.js"><link rel="prefetch" href="/assets/js/19.202ebbab.js"><link rel="prefetch" href="/assets/js/190.9ff32bb2.js"><link rel="prefetch" href="/assets/js/191.227776e1.js"><link rel="prefetch" href="/assets/js/192.daa9b176.js"><link rel="prefetch" href="/assets/js/193.234df76b.js"><link rel="prefetch" href="/assets/js/194.694d7eab.js"><link rel="prefetch" href="/assets/js/195.dbccd798.js"><link rel="prefetch" href="/assets/js/196.f0826c19.js"><link rel="prefetch" href="/assets/js/198.b16405cd.js"><link rel="prefetch" href="/assets/js/199.d1ac766c.js"><link rel="prefetch" href="/assets/js/20.1c163405.js"><link rel="prefetch" href="/assets/js/200.a9d137c9.js"><link rel="prefetch" href="/assets/js/201.9e8d333e.js"><link rel="prefetch" href="/assets/js/202.d8d46dbd.js"><link rel="prefetch" href="/assets/js/203.eacdfaad.js"><link rel="prefetch" href="/assets/js/204.adce41d8.js"><link rel="prefetch" href="/assets/js/205.ca578ff9.js"><link rel="prefetch" href="/assets/js/206.6a336185.js"><link rel="prefetch" href="/assets/js/207.983d3f8f.js"><link rel="prefetch" href="/assets/js/208.6e2745d4.js"><link rel="prefetch" href="/assets/js/209.a42932a6.js"><link rel="prefetch" href="/assets/js/21.c110fe63.js"><link rel="prefetch" href="/assets/js/210.afa16901.js"><link rel="prefetch" href="/assets/js/211.99bb075b.js"><link rel="prefetch" href="/assets/js/212.787e1b16.js"><link rel="prefetch" href="/assets/js/213.ea073177.js"><link rel="prefetch" href="/assets/js/214.8fe5c8cc.js"><link rel="prefetch" href="/assets/js/215.5f4cefd7.js"><link rel="prefetch" href="/assets/js/216.356d8340.js"><link rel="prefetch" href="/assets/js/217.db29a538.js"><link rel="prefetch" href="/assets/js/218.66accfbc.js"><link rel="prefetch" href="/assets/js/219.2390498d.js"><link rel="prefetch" href="/assets/js/22.e6f09907.js"><link rel="prefetch" href="/assets/js/220.65246673.js"><link rel="prefetch" href="/assets/js/221.3baa24a9.js"><link rel="prefetch" href="/assets/js/222.d62f31e6.js"><link rel="prefetch" href="/assets/js/223.4051b754.js"><link rel="prefetch" href="/assets/js/224.875f84c3.js"><link rel="prefetch" href="/assets/js/225.c060a217.js"><link rel="prefetch" href="/assets/js/226.c2eec2e9.js"><link rel="prefetch" href="/assets/js/227.098f8e27.js"><link rel="prefetch" href="/assets/js/228.8be6ae7f.js"><link rel="prefetch" href="/assets/js/23.e66681ea.js"><link rel="prefetch" href="/assets/js/24.252b041b.js"><link rel="prefetch" href="/assets/js/25.96ab5f4a.js"><link rel="prefetch" href="/assets/js/26.608a5d1b.js"><link rel="prefetch" href="/assets/js/27.53ff70b5.js"><link rel="prefetch" href="/assets/js/28.a2bd4260.js"><link rel="prefetch" href="/assets/js/29.de61ac11.js"><link rel="prefetch" href="/assets/js/30.7074037a.js"><link rel="prefetch" href="/assets/js/31.42f329d7.js"><link rel="prefetch" href="/assets/js/32.10c4b1d1.js"><link rel="prefetch" href="/assets/js/33.dc5aba85.js"><link rel="prefetch" href="/assets/js/34.9c5f577a.js"><link rel="prefetch" href="/assets/js/35.096da00f.js"><link rel="prefetch" href="/assets/js/36.cef188e7.js"><link rel="prefetch" href="/assets/js/37.3895543f.js"><link rel="prefetch" href="/assets/js/38.290e609c.js"><link rel="prefetch" href="/assets/js/39.c4f5a502.js"><link rel="prefetch" href="/assets/js/40.ffcb5c5a.js"><link rel="prefetch" href="/assets/js/41.615b8cd3.js"><link rel="prefetch" href="/assets/js/42.070a8456.js"><link rel="prefetch" href="/assets/js/43.45f438ce.js"><link rel="prefetch" href="/assets/js/44.333b37d6.js"><link rel="prefetch" href="/assets/js/45.a0235304.js"><link rel="prefetch" href="/assets/js/46.a2739549.js"><link rel="prefetch" href="/assets/js/47.f6f2afd0.js"><link rel="prefetch" href="/assets/js/48.02eebcc0.js"><link rel="prefetch" href="/assets/js/49.cca68b57.js"><link rel="prefetch" href="/assets/js/5.6ab4bad1.js"><link rel="prefetch" href="/assets/js/50.35b90c07.js"><link rel="prefetch" href="/assets/js/51.babf6c69.js"><link rel="prefetch" href="/assets/js/52.a2cb12d4.js"><link rel="prefetch" href="/assets/js/53.cdc95c94.js"><link rel="prefetch" href="/assets/js/54.07b08901.js"><link rel="prefetch" href="/assets/js/55.a4e7fb54.js"><link rel="prefetch" href="/assets/js/56.7c8475c0.js"><link rel="prefetch" href="/assets/js/57.d62b616a.js"><link rel="prefetch" href="/assets/js/58.727b3415.js"><link rel="prefetch" href="/assets/js/59.f72ed165.js"><link rel="prefetch" href="/assets/js/6.9db196de.js"><link rel="prefetch" href="/assets/js/60.0adc2f64.js"><link rel="prefetch" href="/assets/js/61.be526bd5.js"><link rel="prefetch" href="/assets/js/62.4b595b7b.js"><link rel="prefetch" href="/assets/js/63.33b6f9be.js"><link rel="prefetch" href="/assets/js/64.03b6e77a.js"><link rel="prefetch" href="/assets/js/65.278ee99b.js"><link rel="prefetch" href="/assets/js/66.c3309bfb.js"><link rel="prefetch" href="/assets/js/67.86d207fc.js"><link rel="prefetch" href="/assets/js/68.0f9ea0d0.js"><link rel="prefetch" href="/assets/js/69.aac22b54.js"><link rel="prefetch" href="/assets/js/7.19695e84.js"><link rel="prefetch" href="/assets/js/70.08e3149f.js"><link rel="prefetch" href="/assets/js/71.dda331fc.js"><link rel="prefetch" href="/assets/js/72.8aee99c7.js"><link rel="prefetch" href="/assets/js/73.5046c7ef.js"><link rel="prefetch" href="/assets/js/74.84396701.js"><link rel="prefetch" href="/assets/js/75.d76edc1f.js"><link rel="prefetch" href="/assets/js/76.879ee6b5.js"><link rel="prefetch" href="/assets/js/77.1417b15d.js"><link rel="prefetch" href="/assets/js/78.42f37b21.js"><link rel="prefetch" href="/assets/js/79.87614aa7.js"><link rel="prefetch" href="/assets/js/8.a2d18997.js"><link rel="prefetch" href="/assets/js/80.b3551d66.js"><link rel="prefetch" href="/assets/js/81.a1f8529a.js"><link rel="prefetch" href="/assets/js/82.3f4e5328.js"><link rel="prefetch" href="/assets/js/83.fc59d8de.js"><link rel="prefetch" href="/assets/js/84.cd9c37f2.js"><link rel="prefetch" href="/assets/js/85.6a822a1b.js"><link rel="prefetch" href="/assets/js/86.40f0709f.js"><link rel="prefetch" href="/assets/js/87.3b798c90.js"><link rel="prefetch" href="/assets/js/88.c3297e81.js"><link rel="prefetch" href="/assets/js/89.1cee8bf5.js"><link rel="prefetch" href="/assets/js/9.fe309ea5.js"><link rel="prefetch" href="/assets/js/90.2a9111a5.js"><link rel="prefetch" href="/assets/js/91.6d74ff97.js"><link rel="prefetch" href="/assets/js/92.3b2d151b.js"><link rel="prefetch" href="/assets/js/93.dc804f54.js"><link rel="prefetch" href="/assets/js/94.c3062efe.js"><link rel="prefetch" href="/assets/js/95.206ed12d.js"><link rel="prefetch" href="/assets/js/96.17ee4201.js"><link rel="prefetch" href="/assets/js/97.f64db550.js"><link rel="prefetch" href="/assets/js/98.76a1241d.js"><link rel="prefetch" href="/assets/js/99.49a6b3e4.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.381052ad.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3c92d36b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icons/apple-touch-icon.png" alt="一葦" class="logo"> <span class="site-name can-hide">一葦</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/archives/" class="nav-link">时间轴</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><!----> <span class="title" style="display:;">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/js/" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/frontend/html/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><!----> <span class="title" style="display:;">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/skills/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/skills/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/code/" class="nav-link">源码</a></li><li class="dropdown-item"><!----> <a href="/more/web3/" class="nav-link">Web3</a></li><li class="dropdown-item"><!----> <a href="/more/" class="nav-link">更多</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><!----> <span class="title" style="display:;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>PC端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/vue-node-admin/" class="nav-link">vue-node-admin</a></li><li class="dropdown-subitem"><a href="/skills/vue/vue3-vite-admin.html" class="nav-link">vue3-vite-admin</a></li><li class="dropdown-subitem"><a href="/skills/vue/vue3-cli-admin.html" class="nav-link">vue3-cli-admin</a></li><li class="dropdown-subitem"><a href="/skills/vue/vue3-webpack5-admin.html" class="nav-link">vue3-webpack5-admin</a></li><li class="dropdown-subitem"><a href="/project/mono-react-project.html" class="nav-link">teach-react-mono</a></li></ul></li><li class="dropdown-item"><h4>移动端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/mobile-h5/" class="nav-link">微信h5</a></li><li class="dropdown-subitem"><a href="/project/mini-program/" class="nav-link">微信小程序</a></li><li class="dropdown-subitem"><a href="/project/mobile/" class="nav-link">移动端开发笔记</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/more/ai/" class="nav-link">AI</a></div><div class="nav-item"><a href="/tool/" class="nav-link router-link-active">其他</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><!----> <span class="title" style="display:;">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">ME</a></li><li class="dropdown-item"><!----> <a href="https://github.com/verneyZhou" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="images/poster03.jpeg"> <div class="blogger-info"><h3></h3> <span>是旷野，不是轨道。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/archives/" class="nav-link">时间轴</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><!----> <span class="title" style="display:;">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/js/" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/frontend/html/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><!----> <span class="title" style="display:;">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/skills/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/skills/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/code/" class="nav-link">源码</a></li><li class="dropdown-item"><!----> <a href="/more/web3/" class="nav-link">Web3</a></li><li class="dropdown-item"><!----> <a href="/more/" class="nav-link">更多</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><!----> <span class="title" style="display:;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>PC端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/vue-node-admin/" class="nav-link">vue-node-admin</a></li><li class="dropdown-subitem"><a href="/skills/vue/vue3-vite-admin.html" class="nav-link">vue3-vite-admin</a></li><li class="dropdown-subitem"><a href="/skills/vue/vue3-cli-admin.html" class="nav-link">vue3-cli-admin</a></li><li class="dropdown-subitem"><a href="/skills/vue/vue3-webpack5-admin.html" class="nav-link">vue3-webpack5-admin</a></li><li class="dropdown-subitem"><a href="/project/mono-react-project.html" class="nav-link">teach-react-mono</a></li></ul></li><li class="dropdown-item"><h4>移动端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/project/mobile-h5/" class="nav-link">微信h5</a></li><li class="dropdown-subitem"><a href="/project/mini-program/" class="nav-link">微信小程序</a></li><li class="dropdown-subitem"><a href="/project/mobile/" class="nav-link">移动端开发笔记</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/more/ai/" class="nav-link">AI</a></div><div class="nav-item"><a href="/tool/" class="nav-link router-link-active">其他</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><!----> <span class="title" style="display:;">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">ME</a></li><li class="dropdown-item"><!----> <a href="https://github.com/verneyZhou" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VSCode插件开发笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/vscode-plugins.html#代码自动补全插件" class="sidebar-link">代码自动补全插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#创建项目" class="sidebar-link">创建项目</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#本地调试" class="sidebar-link">本地调试</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#添加到本地" class="sidebar-link">添加到本地</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#发布" class="sidebar-link">发布</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#打包扩展" class="sidebar-link">打包扩展</a></li></ul></li><li><a href="/tool/vscode-plugins.html#vscode翻译插件" class="sidebar-link">VSCode翻译插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#初始化项目" class="sidebar-link">初始化项目</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#接入翻译api" class="sidebar-link">接入翻译API</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#翻译api秘钥本地配置" class="sidebar-link">翻译API秘钥本地配置</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#插件开发" class="sidebar-link">插件开发</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#快捷键和菜单配置" class="sidebar-link">快捷键和菜单配置</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#使用-2" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#上线" class="sidebar-link">上线</a></li></ul></li><li><a href="/tool/vscode-plugins.html#查看文件信息插件" class="sidebar-link">查看文件信息插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#开发" class="sidebar-link">开发</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#发布-2" class="sidebar-link">发布</a></li></ul></li><li><a href="/tool/vscode-plugins.html#chat问答插件" class="sidebar-link">Chat问答插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#初始化项目-2" class="sidebar-link">初始化项目</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#前端项目初始化" class="sidebar-link">前端项目初始化</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#嵌入前端页面" class="sidebar-link">嵌入前端页面</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#前端项目与插件通信" class="sidebar-link">前端项目与插件通信</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#接入文心一言api" class="sidebar-link">接入文心一言API</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#本地调试-2" class="sidebar-link">本地调试</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#发布-3" class="sidebar-link">发布</a></li><li class="sidebar-sub-header"><a href="/tool/vscode-plugins.html#其他" class="sidebar-link">其他</a></li></ul></li><li><a href="/tool/vscode-plugins.html#源码" class="sidebar-link">源码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/tool/vscode-plugins.html#报错记录" class="sidebar-link">报错记录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/tool/vscode-plugins.html#收藏" class="sidebar-link">收藏</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/tool/vscode-plugins.html#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/categories/?category=tool" title="分类" data-v-0c557b5e>tool</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>阿沐</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2024-01-08</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">VSCode插件开发笔记<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="vscode插件开发笔记"><a href="#vscode插件开发笔记" class="header-anchor">#</a> VSCode插件开发笔记</h1> <blockquote><p><a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">VSCode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>应该算是目前使用率最高的代码编辑器了吧，它给我们开放了一些API方便进行插件开发，方便我们解决开发中的一些问题，提高生产效率。</p></blockquote> <h2 id="代码自动补全插件"><a href="#代码自动补全插件" class="header-anchor">#</a> 代码自动补全插件</h2> <blockquote><p>项目开发中，经常会遇到代码补全的功能~</p></blockquote> <p>VsCode本身就有很多内置的代码片段，例如：JavaScript、TypeScript、Markdown 和 PHP；代码片段也可以帮助我们进行快速的输入，一般的代码片段都不止一行代码，可以帮我们省略很多输入。除了内置的代码片段，我们也可以配置自己的代码片段</p> <p><a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets" target="_blank" rel="noopener noreferrer">Snippets in Visual Studio Code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>前端常用的代码补全插件有：<a href="https://marketplace.visualstudio.com/items?itemName=bang.antd-snippets" target="_blank" rel="noopener noreferrer">antd-snippets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://marketplace.visualstudio.com/items?itemName=octref.vetur" target="_blank" rel="noopener noreferrer">vetur<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://marketplace.visualstudio.com/items?itemName=hollowtree.vue-snippets" target="_blank" rel="noopener noreferrer">Vue 3 Snippets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等，这里从0到1实现一个我自己的代码补全插件~</p> <h3 id="创建项目"><a href="#创建项目" class="header-anchor">#</a> 创建项目</h3> <ul><li><p>首先全局安装开发插件的脚手架：<code>npm install -g yo generator-code</code></p> <ol><li><code>yo</code>模块全局安装后就安装了<code>Yeoman</code>，<code>Yeoman</code>是通用型项目脚手架工具，可以根据一套模板，生成一个对应的项目结构;</li> <li><code>generator-code</code>模块是<code>VS Code</code>扩展生成器，与<code>yo</code>配合使用才能构建项目。</li></ol></li> <li><p>安装完成后执行：<code>yo code</code>, 初始化项目：</p></li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>? What <span class="token builtin class-name">type</span> of extension <span class="token keyword">do</span> you want to create? New Code Snippets <span class="token comment"># 选择代码片段</span>
Folder location that contains Text Mate <span class="token punctuation">(</span>.tmSnippet<span class="token punctuation">)</span> and Sublime snippets <span class="token punctuation">(</span>.sublime-snippet<span class="token punctuation">)</span> or press ENTER to start with a new snippet file.
? Folder name <span class="token keyword">for</span> <span class="token function">import</span> or none <span class="token keyword">for</span> new: 
? What<span class="token string">'s the name of your extension? code-snippets 
? What'</span>s the identifier of your extension? code-snippets
? What<span class="token string">'s the description of your extension? ui code snippets
Enter the language for which the snippets should appear. The id is an identifier and is single, lower-case name such as '</span>php<span class="token string">', '</span>javascript'
? Language id: javascript
? Initialize a <span class="token function">git</span> repository? Yes
</code></pre></div><blockquote><p>输入一些基础信息后项目就创建成功了~</p></blockquote> <p>项目目录结构：</p> <div class="language- extra-class"><pre class="language-text"><code>├── .vscode/
├── snippets/
    ├── snippets.json // 配置代码片段
└── package.json
</code></pre></div><p><code>package.json</code>:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;engines&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;vscode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.85.0&quot;</span> <span class="token comment">// 最低支持的vscode版本，使用的vscode需在此版本之上</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;categories&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 分类</span>
    <span class="token string">&quot;Snippets&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;snippets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 代码片段</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 支持js</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./snippets/snippets.json&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>具体参考<a href="https://code.visualstudio.com/api/references/extension-manifest" target="_blank" rel="noopener noreferrer">extension-manifest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li>添加代码片段</li></ul> <p>有一个网站可以帮助我们快速的创建<code>code snippet</code>: <a href="https://snippet-generator.app/" target="_blank" rel="noopener noreferrer">snippet-generator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>在这个网站里，左边输入代码，右侧就会生成 <code>snippet</code> 模板，拷贝到项目中的 <code>snippets.json</code> 文件下的 <code>JSON</code> 对象中即可~</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// snippets/snippets.json</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;fn snippets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 名称</span>
    <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;fn&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//  触发字符，可模糊匹配</span>
    <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 实际插入的代码片段</span>
            <span class="token string">&quot;function fn(${1:val}: number, ${2:val2}: string) {&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 每一项表示换行</span>
            <span class="token string">&quot;    console.log ($CURRENT_YEAR: val, val2);&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;}&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span> <span class="token comment">// 描述说明</span>
      <span class="token string">&quot;快速写一个fn函数&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;调用fn方法&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;@param val — 参数1&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;@param val2 — 参数2.&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>使用<code>$1, $2</code>标识<code>tab</code>定位，使用<code>tab</code>可快速切换</li> <li>使用<code>${1:val}</code>标识<code>tab</code>定位，且有默认值</li> <li>一些内置变量，比如<code>CURRENT_YEAR</code>，可用于自定义注释头</li></ul> <p><a href="https://code.visualstudio.com/docs/editor/userdefinedsnippets#_snippet-syntax" target="_blank" rel="noopener noreferrer">snippet语法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="本地调试"><a href="#本地调试" class="header-anchor">#</a> 本地调试</h3> <ul><li>点击VSCode左侧菜单<code>Run and Debug</code> =&gt; 顶部<code>Extension</code>，运行，会新开一个vscode窗口；</li></ul> <blockquote><p>顶部的调试信息可以在<code>.vscode/launch.json</code>中进行配置~</p></blockquote> <ul><li>新建一个 js 文件夹，输入<code>fn</code>:</li></ul> <img src="/images/tool/vscode01.jpeg" width="auto" class="zoom-custom-imgs"> <blockquote><p>如有上图提示，即表示新添加代码片段生效，点击即会添加配置的代码片段~</p></blockquote> <blockquote><p>这里只是添加一个<code>fn</code>作为示例，其他的代码片段跟这个一样，添加到 <code>json</code> 中即可, 这里不再赘述~</p></blockquote> <h3 id="添加到本地"><a href="#添加到本地" class="header-anchor">#</a> 添加到本地</h3> <blockquote><p>如果只是自己使用，可直接在VSCode本地中新建代码片段~</p></blockquote> <ul><li><code>文件--&gt;首选项--&gt;用户代码片段--&gt;点击新建代码片段</code>, 如：取名<code>vue.json</code>, 确定~</li></ul> <blockquote><p>这是会在<code>~/Library/Application Support/Code/User/snippets/</code>目录下生成一个<code>vue.json.code-snippets</code>文件~</p></blockquote> <ul><li>之后直接在里面添加想要的代码片段即可，保存后，重新打开项目即可使用~</li></ul> <blockquote><p>参考：<a href="https://www.jianshu.com/p/8610215a8a84" target="_blank" rel="noopener noreferrer">VSCode 初次写vue项目并一键生成.vue模版<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>这里如果想把上面的代码片段添加到本地，也是添加到这里即可~</p> <ul><li>也可以通过<code>cmd + shift + P</code> =&gt; 输入<code>user snippets</code> =&gt; <code>新加代码片段</code> 进行添加，将 <code>json</code> 拷贝进去就可以在 <code>vscode</code> 中使用了, 效果是一样的~</li></ul> <h3 id="发布"><a href="#发布" class="header-anchor">#</a> 发布</h3> <blockquote><p>如果是想给团队使用，就可以将该代码片段封装成插件发布，这样别人直接下载对应的插件就可以多个编辑器通用，比存在本地好很多~</p></blockquote> <ul><li><p>发布之前首先得访问<a href="https://login.live.com/" target="_blank" rel="noopener noreferrer">login.live.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>登录<code>Microsoft</code>账号, 可以用 <code>google</code> 邮箱账号，没有注册一个即可；</p></li> <li><p>然后访问<a href="https://aka.ms/SignupAzureDevOps" target="_blank" rel="noopener noreferrer">Azure DevOps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，也是用相同的账号登录；</p></li></ul> <blockquote><p>第一次访问需要先创建一个<code>Azure DevOps</code>组织，默认会创建一个以邮箱前缀为名的组织~</p></blockquote> <ul><li>组织创建成功后，点击右上角的个人头像 =&gt; <code>Personal access tokens</code>，创建个人访问令牌；</li></ul> <blockquote><p>注意: 这里的 <code>organizations</code> 必须要选择 <code>all accessible organizations</code>; <code>Scopes</code> 要选择 <code>full access</code>，否则后面发布会失败。</p></blockquote> <p><strong>创建 <code>token</code> 成功后将<code>token</code>复制，先本地进行保存，之后会用到~！！！</strong></p> <ul><li>之后需要创建一个发布者：发布者是 <a href="https://marketplace.visualstudio.com/" target="_blank" rel="noopener noreferrer">visualstudio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 代码市场的扩展的唯一身份标识。每个插件都需要在 <code>package.json</code> 文件中指定一个 <code>publisher</code> 字段。</li></ul> <p>具体创建点击<a href="https://marketplace.visualstudio.com/manage" target="_blank" rel="noopener noreferrer">发布者管理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，按提示创建即可~</p> <blockquote><p>其中<code>Name</code>和<code>ID</code>是唯一且必填的，可配置<code>Logo</code>和其他自定义信息~</p></blockquote> <p>发布者创建成功后，接下来就可以开始正式发布插件了~！</p> <ul><li><p>首先全局安装<code>vsce</code>: <code>npm install vsce -g</code></p></li> <li><p>输入刚才创建的 publisher 进行登录：<code>vsce login &lt;publisher name&gt;</code>; 再输入刚复制的个人令牌<code>token</code>，即可登录成功；</p></li> <li><p>登录成功之后，就可以发布了；在发布前检查下<code>packge.json</code>信息：</p></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vn-code-snippets&quot;</span><span class="token punctuation">,</span> <span class="token comment">// name</span>
  <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vn-code-snippets&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 显示名称</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ui code snippets&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 描述</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 版本号</span>
  <span class="token property">&quot;publisher&quot;</span><span class="token operator">:</span> <span class="token string">&quot;verneyzhou&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 发布者id</span>
  <span class="token property">&quot;engines&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;vscode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.85.0&quot;</span> <span class="token comment">// 兼容的vscode版本号</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;categories&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 分类</span>
    <span class="token string">&quot;Snippets&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;snippets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 代码片段</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 支持的语言</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./snippets/snippets.json&quot;</span> <span class="token comment">// json路径</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;javascriptreact&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./snippets/snippets.json&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;typescript&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./snippets/snippets.json&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;typescriptreact&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./snippets/snippets.json&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhou&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MIT&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 开源协议</span>
  <span class="token property">&quot;repository&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 代码仓库地址</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;git&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*****&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>之后直接执行<code>vsce publish</code>，即可进行发布~</li></ul> <blockquote><p>如果不出意外，应该就会发布成功；如果报错可能是<code>pkg</code>脚本配置不全，按报错提示检查下吧~</p></blockquote> <div class="language-sh extra-class"><pre class="language-sh"><code>➜  code-snippets git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> ✗ vsce publish
 WARNING  LICENSE.md, LICENSE.txt or LICENSE not found
Do you want to continue? <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span> y
 INFO  Publishing <span class="token string">'verneyzhou.vn-code-snippets v0.0.1'</span><span class="token punctuation">..</span>.
 INFO  Extension URL <span class="token punctuation">(</span>might take a few minutes<span class="token punctuation">)</span>: https://marketplace.visualstudio.com/items?itemName<span class="token operator">=</span>verneyzhou.vn-code-snippets
 INFO  Hub URL: https://marketplace.visualstudio.com/manage/publishers/verneyzhou/extensions/vn-code-snippets/hub
 DONE  Published verneyzhou.vn-code-snippets v0.0.1.
</code></pre></div><ul><li>发布成功之后，在vscode扩展市场应该就可以搜索到该插件了：</li></ul> <p><a href="https://marketplace.visualstudio.com/items?itemName=verneyzhou.vn-code-snippets" target="_blank" rel="noopener noreferrer">https://marketplace.visualstudio.com/items?itemName=verneyzhou.vn-code-snippets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>注意，<code>itemName</code>应该为<code>${publisher}.${name}</code>~</p></blockquote> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <p>之后就跟一般的插件一样，<code>install</code>安装，即可使用了：</p> <img src="/images/tool/vscode02.jpeg" width="auto" class="zoom-custom-imgs"> <p>发布之后也可以取消发布，或删除扩展，更多关于发布的操作可以参考VSCode发布插件官方文档：<a href="https://code.visualstudio.com/api/working-with-extensions/publishing-extension" target="_blank" rel="noopener noreferrer">publishing-extension<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="打包扩展"><a href="#打包扩展" class="header-anchor">#</a> 打包扩展</h3> <blockquote><p>对于某些打算给团队使用，但又不想发布到线上的情况，可以将插件打包，私下分享给别人~</p></blockquote> <p><a href="https://code.visualstudio.com/api/working-with-extensions/publishing-extension#packaging-extensions" target="_blank" rel="noopener noreferrer">包装扩展<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>首先执行打包命令：<code>vsce package</code></li></ul> <blockquote><p>此命令将在扩展的根文件夹下生成一个<code>.vsix</code>文件，如：<code>vn-code-snippets-0.0.1.vsix</code></p></blockquote> <ul><li>安装：
<ul><li>方法1：点击vscode左侧<code>扩展</code>菜单 =&gt; 右上角<code>...</code> =&gt; <code>从 VSIX 安装</code>，选择刚打包生成的文件即可~</li> <li>方法2：打包完成后，终端执行：<code>code --install-extension vn-code-snippets-0.0.1.vsix</code></li></ul></li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>➜  code-snippets git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> ✗ code --install-extension vn-code-snippets-0.0.1.vsix
Installing extensions<span class="token punctuation">..</span>.
<span class="token punctuation">(</span>node:85301<span class="token punctuation">)</span> <span class="token punctuation">[</span>DEP0005<span class="token punctuation">]</span> DeprecationWarning: Buffer<span class="token punctuation">(</span><span class="token punctuation">)</span> is deprecated due to security and usability issues. Please use the Buffer.alloc<span class="token punctuation">(</span><span class="token punctuation">)</span>, Buffer.allocUnsafe<span class="token punctuation">(</span><span class="token punctuation">)</span>, or Buffer.from<span class="token punctuation">(</span><span class="token punctuation">)</span> methods instead.
<span class="token punctuation">(</span>Use <span class="token variable"><span class="token variable">`</span>Electron --trace-deprecation <span class="token punctuation">..</span>.<span class="token variable">`</span></span> to show where the warning was created<span class="token punctuation">)</span>
Extension <span class="token string">'vn-code-snippets-0.0.1.vsix'</span> was successfully installed.
➜  code-snippets git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> ✗ 
</code></pre></div><ul><li>安装完成后即可在扩展中搜到了~，然后直接在代码中使用即可~~~！！！</li></ul> <blockquote><p>如果不生效，重启 vscode 试试~~</p></blockquote> <h2 id="vscode翻译插件"><a href="#vscode翻译插件" class="header-anchor">#</a> VSCode翻译插件</h2> <blockquote><p>在平时项目开发中经常会遇到不认识的英文单词，这里开发一个翻译插件，方便在<code>vscode</code>中直接进行翻译~</p></blockquote> <h3 id="初始化项目"><a href="#初始化项目" class="header-anchor">#</a> 初始化项目</h3> <ul><li>由于上面已经全局安装了<code>yo</code>，这里直接执行：<code>yo code</code>:</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>? What <span class="token builtin class-name">type</span> of extension <span class="token keyword">do</span> you want to create? New Extension <span class="token punctuation">(</span>TypeScript<span class="token punctuation">)</span> <span class="token comment"># 选择ts</span>
? What<span class="token string">'s the name of your extension? translate
? What'</span>s the identifier of your extension? translate <span class="token comment"># 项目名称</span>
? What's the description of your extension? translate extension
? Initialize a <span class="token function">git</span> repository? Yes
? Bundle the <span class="token builtin class-name">source</span> code with webpack? No
? Which package manager to use? <span class="token function">npm</span>
</code></pre></div><blockquote><p>初始化完成后会生成一个项目，接下来看看这个项目默认生成哪些内容~</p></blockquote> <p>项目目录结构：</p> <div class="language- extra-class"><pre class="language-text"><code>├── .vscode/
├── src/
    ├── extension.ts // 初始项目时的入口文件
└── package.json
└── tsconfig.json // ts配置
</code></pre></div><p><code>package.json</code>:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;engines&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;vscode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.85.0&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;commands&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 命令列表</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;translate.helloWorld&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 命令的id</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span> <span class="token comment">// 命名语句</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>初始项目时的入口文件：<code>src/extension.ts</code>:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> vscode <span class="token keyword">from</span> <span class="token string">'vscode'</span><span class="token punctuation">;</span>

<span class="token comment">// 这里执行插件被激活时的操作</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>context<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Congratulations, your extension &quot;translate&quot; is now active!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 注册命令：translate.helloWorld，该命令需在 pkg 已经被定义</span>
	<span class="token comment">// 当执行 translate.helloWorld 命令时，会触发后面的回调函数</span>
	<span class="token keyword">let</span> disposable <span class="token operator">=</span> vscode<span class="token punctuation">.</span>commands<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">'translate.helloWorld'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">// 触发了一个弹出框</span>
		vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showInformationMessage</span><span class="token punctuation">(</span><span class="token string">'Hello World from translate!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 把这个对象放入上下文中, 使其生效</span>
	context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>disposable<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 插件被销毁时调用的方法, 比如可以清除一些缓存, 释放一些内存</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><blockquote><p>接下来我们试着调试下这个插件，看看是否能调试成功~</p></blockquote> <ul><li>打开<code>translate</code>项目，点击<code>VSCode</code>左侧菜单<code>Run and Debug</code> =&gt; <code>顶部Extension</code>，运行，会新开一个<code>vscode</code>调试窗口，这个窗口默认集成了我们当前开发的这个插件工程；</li></ul> <blockquote><p>或者<code>fn + F5</code>也可以新开调试窗口~</p></blockquote> <ul><li>然后<code>cmd + shift + P</code>，输入：<code>Hello World</code>，不出意外的话，项目调试控制台会打印：<code>Congratulations, your extension &quot;translate&quot; is now active!</code>，调试窗口右下角会弹窗展示：<code>Hello World from translate!</code></li></ul> <blockquote><p>这样就表示我们的插件初始化成功~~🎉🎉</p></blockquote> <h3 id="接入翻译api"><a href="#接入翻译api" class="header-anchor">#</a> 接入翻译API</h3> <ul><li><p>翻译API这里选择有道云：首先进入<a href="https://ai.youdao.com/" target="_blank" rel="noopener noreferrer">有道智能云服务平台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，注册，添加微信客服，填写问卷会送50体验金，个人开发够用了；</p></li> <li><p>注册成功后进入到<a href="https://ai.youdao.com/console" target="_blank" rel="noopener noreferrer">有道智云控制台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，首先创建一个应用，选择服务为<code>自然语言翻译服务</code>，接入方式为<code>API</code>；应用创建成功后会获得<code>应用ID</code>和<code>应用秘钥</code>；同时也可以在应用控制台看到js接入实例；</p></li></ul> <p><a href="https://ai.youdao.com/DOCSIRMA/html/trans/api/wbfy/index.html" target="_blank" rel="noopener noreferrer">有道云文本翻译 API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="翻译api秘钥本地配置"><a href="#翻译api秘钥本地配置" class="header-anchor">#</a> 翻译API秘钥本地配置</h3> <blockquote><p>之后在我们的插件中会用到生成的应用ID和应用秘钥；但如果直接在代码中暴露appSecret，有被盗用造成损失的风险，所以这里需要先将<code>appSecret</code>配置在<code>VSCode</code>本地~</p></blockquote> <ul><li><code>package.json</code>中添加配置信息:</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;configuration&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 添加配置</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vscodeVnTranslate&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 自定义字段名称</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 类型</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 属性</span>
        <span class="token property">&quot;vscodeVnTranslate.youdaoAppkey&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 子属性 应用ID</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 类型</span>
          <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;youdao appKey&quot;</span> <span class="token comment">// 描述</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;vscodeVnTranslate.youdaoAppSecret&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 应用秘钥</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;youdao appSecret&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><ul><li>然后打开调试窗口，<code>右上角 Code =&gt; 首选项 =&gt; 设置</code>，展开左侧<code>Extensions</code>菜单，滑到最底部就会看到刚刚新增的<code>vscodeVnTranslate</code>字段；之后将刚创建的应用ID和应用秘钥保存在这里就可以了~</li></ul> <h3 id="插件开发"><a href="#插件开发" class="header-anchor">#</a> 插件开发</h3> <blockquote><p><code>src</code>目录下新建<code>index.ts</code>，添加插件核心逻辑，这里直接看代码吧~</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> vscode <span class="token keyword">from</span> <span class="token string">&quot;vscode&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> CryptoJS <span class="token keyword">from</span> <span class="token string">&quot;crypto-js&quot;</span><span class="token punctuation">;</span> <span class="token comment">// crypto加密</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 接口请求</span>
<span class="token keyword">import</span> querystring <span class="token keyword">from</span> <span class="token string">&quot;querystring&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Word</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 字符串截取前10位和后10位</span>
<span class="token keyword">function</span> <span class="token function">truncate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">q</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
  <span class="token keyword">var</span> len <span class="token operator">=</span> q<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> q<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> q<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> len <span class="token operator">+</span> q<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>len <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 驼峰文本格式化: 例如：将helloWorld转换为hello World</span>
<span class="token keyword">function</span> <span class="token function">changeWord</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">text</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> text<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[A-Z]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> str <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([A-Z])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot; $1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> text<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// 封装有道翻译接口，具体参数参考下方文档</span>
<span class="token comment">// https://ai.youdao.com/DOCSIRMA/html/trans/api/wbfy/index.html</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">youdao</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">query</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">appKey</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">appSecret</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> appKey <span class="token operator">=</span> appKey<span class="token punctuation">;</span>
  <span class="token keyword">var</span> key <span class="token operator">=</span> appSecret<span class="token punctuation">;</span> <span class="token comment">//注意：暴露appSecret，有被盗用造成损失的风险</span>
  <span class="token keyword">var</span> salt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> curtime <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 多个query可以用\n连接  如 query='apple\norange\nbanana\npear'</span>
  <span class="token keyword">var</span> from <span class="token operator">=</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> to <span class="token operator">=</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> str1 <span class="token operator">=</span> appKey <span class="token operator">+</span> <span class="token function">truncate</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token operator">+</span> salt <span class="token operator">+</span> curtime <span class="token operator">+</span> key<span class="token punctuation">;</span>
  <span class="token comment">//  生成加密签名</span>
  <span class="token keyword">var</span> sign <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">SHA256</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
    <span class="token string">&quot;http://openapi.youdao.com/api&quot;</span><span class="token punctuation">,</span>
    querystring<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">q</span><span class="token operator">:</span> <span class="token function">changeWord</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 待翻译文本</span>
      appKey<span class="token punctuation">,</span> <span class="token comment">// 应用id</span>
      salt<span class="token punctuation">,</span> <span class="token comment">// 盐，随机字符串</span>
      from<span class="token punctuation">,</span> <span class="token comment">// 语言</span>
      to<span class="token punctuation">,</span> <span class="token comment">// 目标语言</span>
      sign<span class="token punctuation">,</span> <span class="token comment">// 签名</span>
      <span class="token literal-property property">signType</span><span class="token operator">:</span> <span class="token string">&quot;v3&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 签名类型</span>
      curtime<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这里执行插件被激活时的操作</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">context</span><span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showInformationMessage</span><span class="token punctuation">(</span><span class="token string">'翻译插件成功激活!!!🎉🎉🎉'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 拿到配置文件中的有道翻译的appkey和appSecret</span>
  <span class="token keyword">const</span> config <span class="token operator">=</span> vscode<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getConfiguration</span><span class="token punctuation">(</span><span class="token string">&quot;vscodeVnTranslate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> appKey <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;youdaoAppkey&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">;</span>
  <span class="token keyword">const</span> appSecret <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;youdaoAppSecret&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">;</span>
  <span class="token comment">// 是否开启自动翻译</span>
  <span class="token keyword">const</span> autoTranslate <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;openAutoTranslate&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> boolean<span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'====appSecret'</span><span class="token punctuation">,</span> appSecret<span class="token punctuation">,</span> appKey<span class="token punctuation">,</span> autoTranslate<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 划词hover翻译</span>
  <span class="token comment">// registerHoverProvider：注册hover事件 </span>
  autoTranslate <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span> vscode<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">registerHoverProvider</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// VS code 提供一个 provideHover 当鼠标移动在上面的时候就可以根据当前的单词做一些具体操作</span>
    <span class="token keyword">async</span> <span class="token function">provideHover</span><span class="token punctuation">(</span><span class="token parameter">document<span class="token punctuation">,</span> position<span class="token punctuation">,</span> token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// 获取当前选中的单词  </span>
      <span class="token keyword">const</span> editor <span class="token operator">=</span> vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span>activeTextEditor<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>editor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// No open text editor</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>appKey <span class="token operator">||</span> <span class="token operator">!</span>appSecret<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showWarningMessage</span><span class="token punctuation">(</span><span class="token string">'请配置有道翻译的appkey和appSecret'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 获取选取文本   </span>
      <span class="token keyword">const</span> selection <span class="token operator">=</span> editor<span class="token punctuation">.</span>selection<span class="token punctuation">;</span>
      <span class="token keyword">const</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>text <span class="token operator">||</span> <span class="token operator">!</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// vscode.window.showWarningMessage('请选中需要翻译的单词');</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">youdao</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> appKey<span class="token punctuation">,</span> appSecret<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>errorCode <span class="token operator">!==</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showErrorMessage</span><span class="token punctuation">(</span><span class="token string">'翻译失败：'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>errorCode<span class="token punctuation">,</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// md格式</span>
      <span class="token keyword">const</span> markdownString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">vscode<span class="token punctuation">.</span>MarkdownString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      markdownString<span class="token punctuation">.</span><span class="token function">appendMarkdown</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#### 翻译: \n\n </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>translation<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> \n\n</span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>basic<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 添加音标展示</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>basic<span class="token punctuation">[</span><span class="token string">&quot;us-phonetic&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          markdownString<span class="token punctuation">.</span><span class="token function">appendMarkdown</span><span class="token punctuation">(</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">**美** </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>basic<span class="token punctuation">[</span><span class="token string">&quot;us-phonetic&quot;</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">　　　　**英** </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>basic<span class="token punctuation">[</span><span class="token string">&quot;uk-phonetic&quot;</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">　\n\n</span><span class="token template-punctuation string">`</span></span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 添加解释</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>basic<span class="token punctuation">.</span>explains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span>basic<span class="token punctuation">.</span>explains<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">w</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            markdownString<span class="token punctuation">.</span><span class="token function">appendMarkdown</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>w<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> \n\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 添加网络释义</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>web<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        markdownString<span class="token punctuation">.</span><span class="token function">appendMarkdown</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#### 网络释义 \n\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span>web<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">w</span><span class="token operator">:</span> Word</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          markdownString<span class="token punctuation">.</span><span class="token function">appendMarkdown</span><span class="token punctuation">(</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">**</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>w<span class="token punctuation">.</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:** </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">String</span><span class="token punctuation">(</span>w<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> \n\n</span><span class="token template-punctuation string">`</span></span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      markdownString<span class="token punctuation">.</span>supportHtml <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 支持html标签 </span>
      markdownString<span class="token punctuation">.</span>isTrusted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">vscode<span class="token punctuation">.</span>Hover</span><span class="token punctuation">(</span>markdownString<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hover展示</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 划词翻译替换</span>
  context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
    <span class="token comment">// 注册命令： vscode.translate.replace</span>
    vscode<span class="token punctuation">.</span>commands<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">&quot;vscode.translate.replace&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取当前选中的单词</span>
      <span class="token keyword">let</span> editor <span class="token operator">=</span> vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span>activeTextEditor<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>editor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// No open text editor</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>appKey <span class="token operator">||</span> <span class="token operator">!</span>appSecret<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showWarningMessage</span><span class="token punctuation">(</span><span class="token string">'请配置有道翻译的appkey和appSecret'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> selection <span class="token operator">=</span> editor<span class="token punctuation">.</span>selection<span class="token punctuation">;</span>
      <span class="token keyword">let</span> text <span class="token operator">=</span> editor<span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>text <span class="token operator">||</span> <span class="token operator">!</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showWarningMessage</span><span class="token punctuation">(</span><span class="token string">'请选中需要翻译的单词'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">//有选中翻译选中的词</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">youdao</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> appKey<span class="token punctuation">,</span> appSecret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//vscode.window.showInformationMessage(res.translation[0]);</span>
        <span class="token comment">// 替换选中的文本</span>
        editor<span class="token punctuation">.</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          builder<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>selection<span class="token punctuation">,</span> res<span class="token punctuation">.</span>translation<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 插件被销毁时调用的方法, 比如可以清除一些缓存, 释放一些内存</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><blockquote><p>这里需要用到三个库，直接<code>npm install crypto-js axios querystring</code>即可，如果是<code>ts</code>可能还需要<code>npm install -D @types/crypto-js</code>~</p></blockquote> <ol><li>上方代码实现了一个翻译替换命令<code>vscode.translate.replace</code>，选中需要替换的文本，<code>cmd + shift + p</code>，输入`翻译替换即可；</li></ol> <blockquote><p>下方也配置了右侧菜单和快捷键可执行该命令~</p></blockquote> <ol start="2"><li>同时也实现了鼠标选中文本后，自动翻译文本的功能，该功能可通过配置<code>openAutoTranslate=true</code>来开启;</li></ol> <h3 id="快捷键和菜单配置"><a href="#快捷键和菜单配置" class="header-anchor">#</a> 快捷键和菜单配置</h3> <blockquote><p>可以在<code>package.json</code>中配置快捷键和菜单命令~</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vn-translate-extension&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 插件名称</span>
  <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vn-translate-extension&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 插件</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;一个简单的翻译插件~&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 描述</span>
  <span class="token property">&quot;publisher&quot;</span><span class="token operator">:</span> <span class="token string">&quot;verneyzhou&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 发布者id</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 版本</span>
  <span class="token property">&quot;engines&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;vscode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.85.0&quot;</span> <span class="token comment">// vscode版本</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;categories&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 分类</span>
    <span class="token string">&quot;Other&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;activationEvents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 指明该插件在何种情况下才会被激活，因为只有激活后插件才能被正常使用</span>
    <span class="token string">&quot;onStartupFinished&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 插件启动完成后就会被激活</span>
    <span class="token comment">// &quot;*&quot;, // 只要一启动vscode，插件就会被激活</span>
    <span class="token comment">// &quot;onCommand:extension.sayHello&quot;, // 每当调用命令时，都会激活</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;src/index.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 入口</span>
  <span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 贡献点，通过扩展注册contributes用来扩展Visual Studio Code中的各项技能，其有多个配置</span>
    <span class="token property">&quot;commands&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 命令列表</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vscode.translate.replace&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 命令id</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;翻译替换&quot;</span> <span class="token comment">// 命令名称</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;translate.helloWorld&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hello translate&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;keybindings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 绑定快捷键</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vscode.translate.replace&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 执行命令id</span>
        <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ctrl+t&quot;</span><span class="token punctuation">,</span> <span class="token comment">// window快捷键</span>
        <span class="token property">&quot;mac&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd+t&quot;</span><span class="token punctuation">,</span> <span class="token comment">// mac快键键</span>
        <span class="token property">&quot;when&quot;</span><span class="token operator">:</span> <span class="token string">&quot;editorTextFocus&quot;</span> <span class="token comment">// 触发时机，当文本聚焦的时候</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;menus&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 菜单配置</span>
      <span class="token property">&quot;editor/context&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 编辑器上下文菜单</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;when&quot;</span><span class="token operator">:</span> <span class="token string">&quot;editorTextFocus&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 触发时机，当文本聚焦的时候</span>
          <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vscode.translate.replace&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 执行命令id</span>
          <span class="token property">&quot;group&quot;</span><span class="token operator">:</span> <span class="token string">&quot;navigation&quot;</span> <span class="token comment">// 菜单分组，navigation 会排序到菜单顶部</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;configuration&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 字段配置信息</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vscodeVnTranslate&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;vscodeVnTranslate.youdaoAppkey&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;有道 appKey&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;vscodeVnTranslate.youdaoAppSecret&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;有道 appSecret&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;vscodeVnTranslate.openAutoTranslate&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;boolean&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;是否开启自动翻译&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上方具体配置信息参考下方官方文档：</p> <p><a href="https://code.visualstudio.com/api/references/activation-events" target="_blank" rel="noopener noreferrer">激活事件 activationEvents<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://code.visualstudio.com/api/references/contribution-points" target="_blank" rel="noopener noreferrer">贡献点 contributes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://code.visualstudio.com/api/references/contribution-points#Sorting-of-groups" target="_blank" rel="noopener noreferrer">menus group 菜单排序参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="使用-2"><a href="#使用-2" class="header-anchor">#</a> 使用</h3> <ul><li>本地打开调试窗口时，如果<code>openAutoTranslate</code>配置为<code>true</code>，即可使用文本聚焦自动翻译功能：</li></ul> <img src="/images/tool/vscode03.jpeg" width="auto" class="zoom-custom-imgs"> <ul><li>选中文本，双击呼起右侧菜单时，可看到<code>翻译替换</code>按钮，点击即可替换；也可通过<code>cmd + T</code>快捷键替换：</li></ul> <img src="/images/tool/vscode04.jpeg" width="auto" class="zoom-custom-imgs"> <h3 id="上线"><a href="#上线" class="header-anchor">#</a> 上线</h3> <blockquote><p>上线流程跟<code>vn-code-snippets</code>插件差不多~</p></blockquote> <ul><li><p>不想上线的话，直接<code>vsce package</code>打包扩展生成<code>.vsix</code>文件，然后安装到本地即可使用~</p></li> <li><p>要发布到线上的话，先<code>vsce login</code>登录，再<code>vsce publish</code>发布，参考上方<code>vn-code-snippets</code>的发布即可~</p></li></ul> <blockquote><p>发布成功后等个一两分钟就可以在<a href="https://marketplace.visualstudio.com/items?itemName=verneyzhou.vn-translate-extension" target="_blank" rel="noopener noreferrer">官方市场<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>搜到了~</p></blockquote> <ul><li>发布成功后，扩展市场直接搜索即可使用了~~~！！！🎉🎉🎉</li></ul> <h2 id="查看文件信息插件"><a href="#查看文件信息插件" class="header-anchor">#</a> 查看文件信息插件</h2> <blockquote><p>接下来趁热打铁，再封装一个查看文件信息的插件，大致效果如下：</p></blockquote> <img src="/images/tool/vscode101.gif" width="auto" class="zoom-custom-imgs"> <h3 id="开发"><a href="#开发" class="header-anchor">#</a> 开发</h3> <ul><li><p>开发流程跟上面的翻译插件类似，这里不再赘述了，直接<code>yo code</code> 初始化插件项目；</p></li> <li><p>项目创建完成后，先看下<code>package.json</code>中的配置：</p></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;activationEvents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 在执行 getFileState 指令时激活</span>
    <span class="token string">&quot;onCommand:getFileState&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./out/extension.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commands&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;getFileState&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 定义命令id</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;查看文件信息&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;menus&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 菜单项</span>
        <span class="token property">&quot;editor/context&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 右侧编辑上下文菜单</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;when&quot;</span><span class="token operator">:</span> <span class="token string">&quot;editorFocus&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;getFileState&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;group&quot;</span><span class="token operator">:</span> <span class="token string">&quot;navigation&quot;</span> <span class="token comment">// 菜单顶部展示</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;explorer/context&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>  <span class="token comment">// 左侧资源管理器上下文菜单</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;getFileState&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;group&quot;</span><span class="token operator">:</span> <span class="token string">&quot;navigation&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>再看下核心js逻辑，比翻译插件简单多了：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> vscode <span class="token keyword">from</span> <span class="token string">'vscode'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>

<span class="token comment">// 插件激活时触发，所有代码总入口</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">context</span><span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'file state 插件已经被激活'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 注册命令</span>
    <span class="token keyword">let</span> commandOfGetFileState <span class="token operator">=</span> vscode<span class="token punctuation">.</span>commands<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">'getFileState'</span><span class="token punctuation">,</span> <span class="token parameter">uri</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'uri'</span><span class="token punctuation">,</span> uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 文件路径</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> uri<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'====fs.stat'</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showErrorMessage</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">获取文件时遇到错误了</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!!!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showWarningMessage</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">检测的是文件夹，不是文件，请重新选择！！！</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> size <span class="token operator">=</span> stats<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
                <span class="token keyword">const</span> createTime <span class="token operator">=</span> stats<span class="token punctuation">.</span>birthtime<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">const</span> modifyTime <span class="token operator">=</span> stats<span class="token punctuation">.</span>mtime<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showInformationMessage</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                    Hi, 上午好！
                    今天是：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    又是元气满满的一天呢~~！！！💪🏻💪🏻😄😄🎉🎉

                    您选择的文件路径为:
                    </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>filePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    文件大小为: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>size<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">字节
                    文件创建时间为: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>createTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    文件修改时间为: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>modifyTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">modal</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 将命令放入其上下文对象中，使其生效</span>
    context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>commandOfGetFileState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取时间</span>
<span class="token keyword">function</span> <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> day <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// day.setTime(day.getTime() + 24 * 60 * 60 * 1000);</span>
    <span class="token keyword">const</span> <span class="token literal-property property">weekMap</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token operator">:</span> <span class="token string">'一'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token string">'二'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token string">'三'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token string">'四'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">:</span> <span class="token string">'五'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token operator">:</span><span class="token string">'六'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token string">'日'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token operator">:</span> <span class="token string">'日'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> week <span class="token operator">=</span> weekMap<span class="token punctuation">[</span>day<span class="token punctuation">.</span><span class="token function">getDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 周</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>week<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> date<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>注意：</strong> 上面的<code>showInformationMessage</code>方法添加的<code>{modal: true}</code>参数，需要在<code>首选项 =&gt; Settings</code> 中添加:</p> <p><code>&quot;window.dialogStyle&quot;: &quot;custom&quot;</code></p> <p>弹窗样式才能生效哦~</p> <h3 id="发布-2"><a href="#发布-2" class="header-anchor">#</a> 发布</h3> <blockquote><p>本地调试完成后就可以进行发布了~</p></blockquote> <p>可以选择打包扩展，也可以直接发布线上；具体流程参考上面翻译插件，不细讲了~</p> <h2 id="chat问答插件"><a href="#chat问答插件" class="header-anchor">#</a> Chat问答插件</h2> <blockquote><p>这里开发一个Chat插件，主要会用到 VSCode 的 Webview 功能~</p></blockquote> <p><a href="https://code.visualstudio.com/api/extension-guides/webview" target="_blank" rel="noopener noreferrer">VSCode-WebviewAPI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <code>Webview API</code> 允许扩展在 visualstudio 代码中创建完全可定制的视图，可以将 webview 看作是 VS Code 中的 iframe。</p> <h3 id="初始化项目-2"><a href="#初始化项目-2" class="header-anchor">#</a> 初始化项目</h3> <ul><li>这里直接<code>yo code</code>创建项目，跟上面的翻译插件一样的，这里就不展示了~</li></ul> <blockquote><p>初始化项目完成后，可以先本地调试下，试下是否调通~</p></blockquote> <h3 id="前端项目初始化"><a href="#前端项目初始化" class="header-anchor">#</a> 前端项目初始化</h3> <blockquote><p>因为VSCode可以用<code>iframe</code>展示线上web网页, 所以这里新起一个前端项目，用于展示视图~</p></blockquote> <p><a href="https://vitejs.cn/" target="_blank" rel="noopener noreferrer">vite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>这里是用 vite 快速启了一个vue3项目，<code>npm run dev</code>后本地服务地址为<code>http://localhost:5173/</code>，之后会用到~</li></ul> <h3 id="嵌入前端页面"><a href="#嵌入前端页面" class="header-anchor">#</a> 嵌入前端页面</h3> <blockquote><p>接下来将web页面展示在vscode侧边栏~</p></blockquote> <p>vscode 提供了两种创建iframe的方法，<code>WebviewViewProvider</code> 和 <code>createWebviewPanel</code>，选其一即可，这里我们介绍一下<code>WebviewViewProvider</code>如何使用</p> <ul><li>首先需要在 pkg 中配置视图信息：</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commands&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;viewsContainers&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 自定义视图的视图容器, 必须指定视图容器的标识符、标题和图标</span>
      <span class="token property">&quot;activitybar&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 活动栏</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chat-sidebar-view&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 容器id, 确保在下方views中有对应的视图</span>
          <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;聊一下&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 标题</span>
          <span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;images/chat-icon.png&quot;</span> <span class="token comment">// 图标</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;views&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 定义视图</span>
      <span class="token property">&quot;chat-sidebar-view&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webview&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 类型为webview</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chat-sidebar-view&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 容器id</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot; 聊一下&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;images/chat-icon.png&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;contextualTitle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;聊一下&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><blockquote><p><code>views</code> 是配置视图列表,<code>activitybar</code> 是定义下显示在侧边导航上的视图。</p></blockquote> <ul><li>然后在<code>extention.ts</code>注册视图模块，同时引入侧边栏视图<code>ChatWebview</code>：</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> vscode <span class="token keyword">from</span> <span class="token string">'vscode'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ChatWebview <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./chatWebview&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 插件的入口函数, 当插件第一次加载时会执行activate</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span>context<span class="token operator">:</span> vscode<span class="token punctuation">.</span>ExtensionContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Congratulations, your extension &quot;chat&quot; is now active!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 实现侧边栏的初始化</span>
	<span class="token comment">// 实例化一个chatWebview</span>
	<span class="token keyword">const</span> chatWebview <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChatWebview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 注册webview 到id为 chat-sidebar-view 的views中，这个id为 chat-sidebar-view 的视图我们稍后会在</span>
	<span class="token comment">// package.json 中声明，先理解为我们要把iframe渲染在那个地方（侧边栏还是标签页）需要在 package.json 中控制</span>
	context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
		vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">registerWebviewViewProvider</span><span class="token punctuation">(</span><span class="token string">&quot;chat-sidebar-view&quot;</span><span class="token punctuation">,</span> chatWebview<span class="token punctuation">)</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 这里实现了一个简单的功能，在vscode打开的文件中，选中代码时会实时展示在web页面上</span>
	<span class="token comment">// 监听用户选中文本事件</span>
	vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">onDidChangeTextEditorSelection</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> editor <span class="token operator">=</span> event<span class="token punctuation">.</span>textEditor<span class="token punctuation">;</span>
		<span class="token keyword">let</span> document <span class="token operator">=</span> editor<span class="token punctuation">.</span>document<span class="token punctuation">;</span>
		<span class="token keyword">let</span> selection <span class="token operator">=</span> editor<span class="token punctuation">.</span>selection<span class="token punctuation">;</span>
	<span class="token comment">// 获取当前窗口的文本</span>
		<span class="token keyword">let</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'===onDidChangeTextEditorSelection'</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 上文提到chatWebview可能为null 因此需要可选链写法，所以这里存在不稳定性，不过测试没问题~</span>
		chatWebview<span class="token operator">?.</span>webview<span class="token operator">?.</span>webview<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment">// 第一次postMessage，下一次在chatWebview文件的iframe中</span>
		command<span class="token operator">:</span> <span class="token string">&quot;vscodeSendMesToWeb&quot;</span><span class="token punctuation">,</span>
		data<span class="token operator">:</span> text<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>接着就是最重要的，新建<code>chatWebView.ts</code>文件，实现页面的展示:</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/chatWebView.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> window<span class="token punctuation">,</span> Position<span class="token punctuation">,</span> WebviewView<span class="token punctuation">,</span> WebviewViewProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vscode&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ChatWebview</span> <span class="token keyword">implements</span> <span class="token class-name">WebviewViewProvider</span> <span class="token punctuation">{</span>
  <span class="token comment">// 写一个public变量，方便对象引用创建后的webview实例，但是可能存在还未完全解析完成时，访问值为null</span>
  <span class="token comment">// 看了vscode api发现，resolveWebView 返回一个 Thenable，可以在解析完成后拿到webview实例</span>
  <span class="token comment">// 但是这个函数是在webview容器第一次显示时自动执行，不需要手动调用，不知道怎么拿到Thenable</span>
  <span class="token keyword">public</span> webview<span class="token operator">:</span> WebviewView <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token function">resolveWebviewView</span><span class="token punctuation">(</span>webviewView<span class="token operator">:</span> WebviewView<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">|</span> Thenable<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>webview <span class="token operator">=</span> webviewView<span class="token punctuation">;</span>
    webviewView<span class="token punctuation">.</span>webview<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{</span>
      enableScripts<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 监听web端传来的消息</span>
    webviewView<span class="token punctuation">.</span>webview<span class="token punctuation">.</span><span class="token function">onDidReceiveMessage</span><span class="token punctuation">(</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span>command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;WebSendMesToVscode&quot;</span><span class="token operator">:</span>
          <span class="token comment">// 实现一个简单的功能，将web端传递过来的消息插入到当前活动编辑器中</span>
          <span class="token keyword">let</span> editor <span class="token operator">=</span> window<span class="token punctuation">.</span>activeTextEditor<span class="token punctuation">;</span>
          editor<span class="token operator">?.</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">(</span>edit<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> position <span class="token operator">=</span> editor<span class="token operator">?.</span>selection
              <span class="token operator">?</span> editor<span class="token operator">?.</span>selection<span class="token punctuation">.</span>start
              <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Position</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            edit<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> message<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// webview 展示的内容本身就是嵌套在一个iframe中，因此在此html中再嵌套一个iframe时，需要传递两次postMessage</span>
    webviewView<span class="token punctuation">.</span>webview<span class="token punctuation">.</span>html <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;!DOCTYPE html&gt;
      &lt;html lang=&quot;en&quot;&gt;
      &lt;head&gt;
        &lt;meta charset=&quot;UTF-8&quot;&gt;
        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
        &lt;style&gt;
        html,
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color:#000000;
            overflow:hidden;
        }
        .webView_iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .outer{
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
      &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;script&gt;
      
      console.log('Hello from the webview!');
      // 向vscode 传递消息的固定写法, vscode 为我们封装好了postMessage
      const vscode = acquireVsCodeApi();
      // 接收来自web页面的消息
      window.addEventListener('message', event =&gt; {
          const message = event.data;
          switch (message.command) {
               // 插件传递消息给web端
              case 'vscodeSendMesToWeb':
                  let iframe = document.getElementById('WebviewIframe')
                  WebviewIframe.contentWindow.postMessage(message, &quot;*&quot;)
                  console.log(&quot;fromWebViewIframe: &quot;+message.data)
                  break;
              // web端发送消息给插件
              case 'WebSendMesToVscode':
                    vscode.postMessage(message);
                    break;
          }
      });

     &lt;/script&gt;
        &lt;div class=&quot;outer&quot;&gt;
           &lt;iframe id='WebviewIframe' class=&quot;webView_iframe&quot; sandbox=&quot;allow-scripts allow-same-origin allow-forms allow-pointer-lock allow-downloads&quot; allow=&quot;cross-origin-isolated; clipboard-read; clipboard-write;&quot; src=&quot;http://localhost:5173/&quot;&gt;&lt;/iframe&gt;
        &lt;/div&gt;
    &lt;/body&gt;
    &lt;/html&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>我们刚启动的前端服务<code>http://localhost:5173/</code>会被嵌套在<code>iframe</code>中~</p></blockquote> <p><code>webviewView.webview.onDidReceiveMessage</code>就是监听 web 端向 vscode 发的消息；</p> <p><code>webviewView.webview.html</code>里面的内容会被 <code>webview</code> 嵌套在一个<code>父iframe</code>中，而我们的前端页面<code>http://localhost:5173/</code>会嵌套到<code>父iframe</code>的<code>子iframe</code>中，所以需要在<code>父iframe</code>中通过<code>window.addEventListener('message', ...)</code>监听 vscode 和 web 之间的通信，并作为通道将双方的通信信息传递过去；</p> <ul><li>这时打开左上角的<code>Run Extension</code>按钮，会新开一个调试窗口；这时会看到左侧多了一个图标按钮，点击就可以看到我们启动的页面了~~~！！！</li></ul> <img src="/images/tool/vscode201.jpeg" width="auto" class="zoom-custom-imgs"> <blockquote><p>如果想像<code>Chrome</code>浏览器中打开调试控制台，点击顶部<code>Help =&gt; Toggle Developer Tools</code>即可开始调试了~</p></blockquote> <h3 id="前端项目与插件通信"><a href="#前端项目与插件通信" class="header-anchor">#</a> 前端项目与插件通信</h3> <blockquote><p>上面是实现前端页面嵌入的核心js代码了，接下来解析 web 跟 vscode 是如何通信的：</p></blockquote> <img src="/images/tool/vscode202.jpeg" width="auto" class="zoom-custom-imgs"> <p>如上图所示，首先是 <code>web =&gt; vscode</code> 通信：</p> <ol><li>首先在页面中的<code>click</code>事件中，点击会通过<code>window.parent.postMessage</code>向 vscode 发送信息；</li> <li>之后在 <code>chatWebview.ts</code>的<code>webviewView.webview.onDidReceiveMessage</code>中就会监听到 web 传过来的信息；</li></ol> <p><code>vscode =&gt; web</code> 通信：</p> <ol><li>代码中通过<code>vscode.window.onDidChangeTextEditorSelection</code>事件监听用户选中文本事件，同时通过<code>chatWebview?.webview?.webview.postMessage</code>向 web 传递信息；</li> <li>在前端代码中，通过 <code>window.addEventListener(&quot;message&quot;, ...)</code>监听 vscode 传过来的信息，从而实现通信。</li></ol> <h3 id="接入文心一言api"><a href="#接入文心一言api" class="header-anchor">#</a> 接入文心一言API</h3> <blockquote><p>这里接入的大语言模型看你自己选择，国外的<a href="https://platform.openai.com/docs/overview" target="_blank" rel="noopener noreferrer">OpenAI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://ai.google.dev/docs?hl=zh-cn" target="_blank" rel="noopener noreferrer">Gemini<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，国内的文心一言等等，都可以；为了方便，我这边选择的是百度的文心一言~</p></blockquote> <p><a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/index.html" target="_blank" rel="noopener noreferrer">百度智能云千帆大模型平台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>首先登录<a href="https://cloud.baidu.com" target="_blank" rel="noopener noreferrer">百度智能云<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，注册开发者账号，实名认证，流程比较简单，这里不再赘述了；</p></li> <li><p>接着进入<a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/jlil56u11" target="_blank" rel="noopener noreferrer">ERNIE-Bot API文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，查看调用它的API需要怎么做；</p></li></ul> <blockquote><p>ERNIE-Bot是百度自行研发的大语言模型，覆盖海量中文数据，具有更强的对话问答、内容创作生成等能力。</p></blockquote> <ul><li><p>接下来创建应用：进入<a href="https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application" target="_blank" rel="noopener noreferrer">应用接入<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, 点击【创建应用】，输入应用名称，描述即可；创建成功后即会生成<code>API Key</code>和<code>Secret Key</code>；</p></li> <li><p>然后进入<a href="https://console.bce.baidu.com/tools/?u=bce-head#/api?product=AI&amp;project=%E5%8D%83%E5%B8%86%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B3%E5%8F%B0&amp;parent=ERNIE-Bot&amp;api=rpc%2F2.0%2Fai_custom%2Fv1%2Fwenxinworkshop%2Fchat%2Fcompletions&amp;method=post" target="_blank" rel="noopener noreferrer">调试API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>页面，如图选择自己创建的应用，输入<code>body</code>信息，开始调试：</p></li></ul> <img src="/images/tool/vscode203.jpeg" width="auto" class="zoom-custom-imgs"> <ul><li>接下来就可以在项目中新建一个文件夹，用<code>Node.js</code>接入文心一言的API了，具体接入传参什么的参考官方文档就行；</li></ul> <blockquote><p>这里node后端项目的搭建这里不再赘述了，我用的是express搭建的，接下来主要展示核心代码~</p></blockquote> <ul><li><code>chat.js</code>:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// server/chat.js</span>

<span class="token keyword">const</span> <span class="token constant">ERNIEB</span> <span class="token operator">=</span><span class="token string">&quot;https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 获取token</span>
<span class="token keyword">async</span> <span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id='</span> <span class="token operator">+</span> <span class="token constant">AK</span> <span class="token operator">+</span> <span class="token string">'&amp;client_secret='</span> <span class="token operator">+</span> <span class="token constant">SK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>access_token<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token comment">// 封装聊天接口</span>
<span class="token keyword">async</span> <span class="token function">ask</span><span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 问句push进去</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> prompt <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
      <span class="token constant">ERNIEB</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">messages</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messages <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">access_token</span><span class="token operator">:</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 答案也放进去</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;assistant&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> data<span class="token punctuation">.</span>result <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> data<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;调用模型失败&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>大致逻辑就是按API文档直接调用接口，然后用node封装一层，之后前端直接调用即可~ 具体实现逻辑见源码~</p></blockquote> <ul><li>本地启动前端服务，node服务，再<code>Run Extension</code>, 就可以开始本地调试了：</li></ul> <img src="/images/tool/vscode204.png" width="auto" class="zoom-custom-imgs"> <blockquote><p>其实这个插件的client目录就是一个完全的前端web项目了，只是通过 vscode 的 webview 将前端的url通过iframe的形式嵌入进来；client就算单独作为一个引入大模型的项目也是成立的，这个插件只是加了跟web页面的通信~</p></blockquote> <h3 id="本地调试-2"><a href="#本地调试-2" class="header-anchor">#</a> 本地调试</h3> <ul><li><p>进入client项目，<code>npm run vercel</code>启动项目；</p></li> <li><p>然后回到<code>chat</code>目录，将<code>chatWebview.ts</code>中的<code>webUrl</code>设置为 client 的本地启动地址，<code>Run Extension</code>打开调试窗口，点击左侧【聊】图标即可开始调试；</p></li> <li><p><code>client</code>中有修改，点击vscode的刷新按钮即可刷新；</p></li></ul> <h3 id="发布-3"><a href="#发布-3" class="header-anchor">#</a> 发布</h3> <ul><li><p>首先将client前端项目部署vercel: 进入到 vercel 目录，<code>vercel --prod</code>；</p></li> <li><p>将 <code>chatWebview.ts</code>下的<code>webUrl</code>改为vercel线上地址，回到<code>chat</code>目录:</p> <ol><li><code>vsce package</code> 打包扩展；</li> <li><code>vsce publish</code> 发布到线上；</li></ol></li></ul> <blockquote><p>关于插件的发布配置上面已经讲过了，这里不再赘述，参考上面就可以了~</p></blockquote> <ul><li>发布成功后直接搜索<code>vn-chat-extension</code>即可使用了~</li></ul> <p><a href="https://marketplace.visualstudio.com/items?itemName=verneyzhou.vn-chat-extension" target="_blank" rel="noopener noreferrer">插件地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h3> <ul><li><p>聊天界面UI优化</p></li> <li><p>聊天接口token获取优化，appKey在vscode本地存储</p></li></ul> <blockquote><p>这里appKey的存储可以参考上方翻译插件，存储在vscode本地，然后通过<code>postMessage</code>传给前端web项目~</p></blockquote> <ul><li>client和server部署</li></ul> <blockquote><p>这里用 vercel 的 <code>serverless functions</code> 来部署后端接口，具体参考之前的<a href="/more/vercel-deploy.html">Vercel部署笔记</a></p></blockquote> <ul><li><p>增加连续对话能力</p></li> <li><p>引入其他API,比如openAI, Gemini等等</p></li></ul> <h2 id="源码"><a href="#源码" class="header-anchor">#</a> 源码</h2> <p>上面的实战项目的完整代码都在<a href="https://github.com/verneyZhou/vscode-plugins-project" target="_blank" rel="noopener noreferrer">vscode-plugins-project<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>~</p> <h2 id="报错记录"><a href="#报错记录" class="header-anchor">#</a> 报错记录</h2> <ul><li>翻译插件本地调试时报错：<code>Activating extension 'verneyzhou.vn-translate-extension' failed: Cannot use import statement outside a module.</code></li></ul> <blockquote><p>调试时，pkg中的<code>main</code>指向打包后的js文件就暂时好了~</p></blockquote> <ul><li>chat插件，client项目 <code>vercel dev</code> 本地调试的时候，<code>api/</code>下的接口没生效，但部署到vercel上生效的？</li></ul> <blockquote><p>我这边重新新创建一个vite项目，重新配置vercel，重新添加接口后就可以了？！...暂时无解，，，可能是之前的client项目配置vercel哪里有问题吧...</p></blockquote> <h2 id="收藏"><a href="#收藏" class="header-anchor">#</a> 收藏</h2> <ul><li><p><a href="https://code.visualstudio.com/api/get-started/your-first-extension" target="_blank" rel="noopener noreferrer">VSCode插件开发官方文档: Your First Extension<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://liiked.github.io/VS-Code-Extension-Doc-ZH" target="_blank" rel="noopener noreferrer">VSCode插件开发中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://github.com/microsoft/vscode-extension-samples" target="_blank" rel="noopener noreferrer">VS Code Extension Samples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://zhuanlan.zhihu.com/p/166683895" target="_blank" rel="noopener noreferrer">VSCode插件开发（韭菜盒子），做最好用的股票和基金插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://juejin.cn/post/7033631156616888328" target="_blank" rel="noopener noreferrer">一起来写 VS Code 插件：VS Code 版 CNode 已上线<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><p><a href="https://juejin.cn/post/7030250953215311908" target="_blank" rel="noopener noreferrer">一起来写 VS Code 插件:为你的团队提供常用代码片段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://juejin.cn/post/7031878482367873037" target="_blank" rel="noopener noreferrer">一起来写 VS Code 插件：实现一个翻译插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://segmentfault.com/a/1190000040720760" target="_blank" rel="noopener noreferrer">从0到1开发一款自己的vscode插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://juejin.cn/post/7298160530291376140" target="_blank" rel="noopener noreferrer">发布自己的 vscode 大模型问答插件，vue+nodejs 接入文心一言api<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://segmentfault.com/a/1190000038553748" target="_blank" rel="noopener noreferrer">记一次前端&quot;vscode插件编写实战&quot;超详细的分享会(建议收藏哦)(上篇)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://segmentfault.com/a/1190000038617902" target="_blank" rel="noopener noreferrer">记一次前端&quot;vscode插件编写实战&quot;超详细的分享会(建议收藏哦)(下篇)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=vscode" title="标签">#vscode</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">1/15/2024, 1:36:41 AM</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/more/node-deploy.html"><div>
            Vue+Node实现可视化部署工具
            <!----></div></a> <span class="date">01-21</span></dt></dl><dl><dd>02</dd> <dt><a href="/skills/vue/vue3-cli-repo.html"><div>
            开发一个快速搭建vue3项目的脚手架
            <!----></div></a> <span class="date">12-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/skills/vue/vue-design.html"><div>
            从0到1搭建Monorepo组件库项目
            <!----></div></a> <span class="date">12-03</span></dt></dl> <dl><dd></dd> <dt><a href="/archives" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2024
    <span>一苇 | <a href="https://beian.miit.gov.cn/" target="_blank" style="font-weight:normal"><img src="/blog/images/icp.png" width="20" height="20" alt="公网备案"/>京ICP备2021006935号-2</a> </span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><!----><!----><div></div></div></div>
    <script src="/assets/js/app.2e7fb202.js" defer></script><script src="/assets/js/3.7ffbe2ab.js" defer></script><script src="/assets/js/197.06887a14.js" defer></script><script src="/assets/js/4.245b4373.js" defer></script>
  </body>
</html>
